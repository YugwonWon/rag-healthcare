"""
í™˜ê²½ì„¤ì • ê´€ë¦¬ ëª¨ë“ˆ (pydantic-settings)
ì¹˜ë§¤ë…¸ì¸ í—¬ìŠ¤ì¼€ì–´ RAG ì±—ë´‡ ì„¤ì •
"""

from functools import lru_cache
from typing import Optional
from pydantic_settings import BaseSettings
from pydantic import Field


class Settings(BaseSettings):
    """ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •"""
    
    # ê¸°ë³¸ ì„¤ì •
    APP_NAME: str = "ì¹˜ë§¤ë…¸ì¸ ë§ì¶¤í˜• í—¬ìŠ¤ì¼€ì–´ RAG ì±—ë´‡"
    APP_VERSION: str = "0.1.0"
    DEBUG: bool = False
    
    # API ì„¤ì •
    API_HOST: str = "0.0.0.0"
    API_PORT: int = 8000
    
    # LLM ì„¤ì • (Ollama)
    # ============================================================
    # ì§€ì› ëª¨ë¸ ëª©ë¡:
    # - exaone-counseling: LGAI-EXAONE/EXAONE-4.0-1.2B (ì´ì „ ëª¨ë¸)
    #   â”” íŠ¹ì§•: 1.28B ê²½ëŸ‰, ì˜¨ë””ë°”ì´ìŠ¤ ìµœì í™”, í•œêµ­ì–´ ì§€ì›
    #   â”” GGUF: models/EXAONE-4.0-1.2B-Q4_K_M.gguf
    #   â”” CPU ì¶”ë¡  ì†ë„ ìš°ìˆ˜ (1.2B ê²½ëŸ‰)
    #
    # - kanana-counseling: Kakao Kanana-nano 2.1B Instruct (í˜„ì¬ ëª¨ë¸)
    #   â”” HuggingFace: kakaocorp/kanana-nano-2.1b-instruct
    #   â”” GGUF: kanana-nano-2.1b-instruct-q4_k_m.gguf
    #
    # - qwen2.5:3b: Alibaba Qwen 2.5 3B
    #   â”” Ollama ê³µì‹ ëª¨ë¸
    # ============================================================
    OLLAMA_BASE_URL: str = "http://localhost:11434"
    OLLAMA_MODEL: str = "kanana-counseling"  # Kanana 2.1B íŒŒì¸íŠœë‹ëœ ìƒë‹´ ëª¨ë¸
    LLM_TEMPERATURE: float = 0.4  # ë‹¤ì–‘í•œ ìœ ë„ ì§ˆë¬¸ ìƒì„±ì„ ìœ„í•´ 0.1 â†’ 0.4
    LLM_MAX_TOKENS: int = 512  # ê³µê°+ì„¤ëª…+ìœ ë„ì§ˆë¬¸ ê³µê°„ í™•ë³´ (256ì€ ìœ ë„ì§ˆë¬¸ ì „ì— ì˜ë¦¼)
    
    # OpenAI ì„¤ì • (Fallbackìš©)
    OPENAI_API_KEY: Optional[str] = None
    OPENAI_MODEL: str = "gpt-4o-mini"
    
    # ì„ë² ë”© ì„¤ì • (ì˜¨ë””ë°”ì´ìŠ¤)
    EMBEDDING_MODEL: str = "sentence-transformers/all-MiniLM-L6-v2"
    EMBEDDING_DIMENSION: int = 384
    EMBEDDING_DEVICE: str = "cpu"  # cpu, cuda, mps
    
    # PostgreSQL + pgvector ì„¤ì • (LangChain ë°ì´í„° ë ˆì´ì–´)
    # Cloud SQL ì—°ê²° ë¬¸ìì—´ í˜•ì‹:
    # - ë¡œì»¬: postgresql://user:pass@localhost:5432/dbname
    # - Cloud SQL (Unix Socket): postgresql://user:pass@/dbname?host=/cloudsql/project:region:instance
    DATABASE_URL: Optional[str] = None
    
    # Cloud SQL ê°œë³„ í™˜ê²½ ë³€ìˆ˜ (Secret Manager ì§€ì›)
    DB_HOST: Optional[str] = None  # /cloudsql/project:region:instance
    DB_NAME: Optional[str] = None
    DB_USER: Optional[str] = None
    DB_PASSWORD: Optional[str] = None  # Secret Managerì—ì„œ ì£¼ì…
    
    @property
    def database_url(self) -> Optional[str]:
        """DATABASE_URL ë˜ëŠ” ê°œë³„ í™˜ê²½ ë³€ìˆ˜ë¡œ ì—°ê²° ë¬¸ìì—´ ìƒì„±"""
        if self.DATABASE_URL:
            return self.DATABASE_URL
        # ê°œë³„ í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì¡°í•© (Cloud Run + Secret Manager)
        if all([self.DB_HOST, self.DB_NAME, self.DB_USER, self.DB_PASSWORD]):
            if self.DB_HOST.startswith("/cloudsql/"):
                # Unix ì†Œì¼“ ì—°ê²°
                return f"postgresql://{self.DB_USER}:{self.DB_PASSWORD}@/{self.DB_NAME}?host={self.DB_HOST}"
            else:
                # TCP ì—°ê²°
                return f"postgresql://{self.DB_USER}:{self.DB_PASSWORD}@{self.DB_HOST}/{self.DB_NAME}"
        return None

    
    # ëŒ€í™” ê¸°ë¡ ì„¤ì •
    CONVERSATION_COLLECTION_NAME: str = "conversations"
    MAX_CONVERSATION_HISTORY: int = 10
    
    # ëŒ€í™” ìš”ì•½ ì„¤ì •
    CONVERSATION_SUMMARY_THRESHOLD: int = 10  # ìš”ì•½ ìƒì„± ê¸°ì¤€ ëŒ€í™” ìˆ˜
    CONVERSATION_SUMMARY_ENABLED: bool = True  # ìš”ì•½ ê¸°ëŠ¥ í™œì„±í™” ì—¬ë¶€
    
    # RAG ì„¤ì •
    RAG_TOP_K: int = 5
    RAG_SIMILARITY_THRESHOLD: float = 0.5
    
    # GraphRAG ì„¤ì •
    GRAPHRAG_ENABLED: bool = True  # GraphRAG ì§€ì‹ê·¸ë˜í”„ ì‚¬ìš© ì—¬ë¶€
    GRAPHRAG_MAX_DEPTH: int = 2    # ì§€ì‹ê·¸ë˜í”„ íƒìƒ‰ ê¹Šì´
    
    # Neo4j ì„¤ì •
    NEO4J_URI: Optional[str] = None
    NEO4J_USERNAME: str = "neo4j"
    NEO4J_PASSWORD: Optional[str] = None
    NEO4J_DATABASE: str = "neo4j"
    
    # LangGraph ì„¤ì •
    LANGGRAPH_FOLLOWUP_MIN_CONFIDENCE: float = 0.5  # í›„ì† ì§ˆë¬¸ ë¶„ë¥˜ ìµœì†Œ ì‹ ë¢°ë„
    
    # í—¬ìŠ¤ì¼€ì–´ ë„ë©”ì¸ ì„¤ì •
    PATIENT_PROFILE_COLLECTION: str = "patient_profiles"
    MEDICATION_REMINDER_ENABLED: bool = True
    DAILY_ROUTINE_TRACKING: bool = False  # ì¼ìƒ ë£¨í‹´ ì¶”ì  ë¹„í™œì„±í™” (ëŒ€í™” ë§¥ë½ ìœ ì§€)
    
    # íŒŒì¸íŠœë‹ ëª¨ë¸ ì„¤ì •
    FINETUNED_MODEL_PATH: Optional[str] = None
    USE_FINETUNED_MODEL: bool = False
    
    # Cloud Run ì„¤ì •
    CLOUD_RUN_URL: Optional[str] = None
    
    # HuggingFace ì„¤ì •
    HF_TOKEN: Optional[str] = None
    
    class Config:
        env_file = ".env"
        env_file_encoding = "utf-8"
        case_sensitive = True
        extra = "ignore"  # ì •ì˜ë˜ì§€ ì•Šì€ í™˜ê²½ë³€ìˆ˜ ë¬´ì‹œ


class HealthcarePrompts:
    """í—¬ìŠ¤ì¼€ì–´ ë„ë©”ì¸ íŠ¹í™” í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿"""
    
    SYSTEM_PROMPT = """ë‹¹ì‹ ì€ ì¹˜ë§¤ë…¸ì¸ì„ ëŒë³´ëŠ” ë”°ëœ»í•œ ë…¸ì¸ê±´ê°•ì „ë¬¸ìƒë‹´ì‚¬ì…ë‹ˆë‹¤.

## ì‘ë‹µ êµ¬ì¡° (ë°˜ë“œì‹œ ì´ ìˆœì„œë¥¼ ë”°ë¥´ì„¸ìš”)
1. **ê³µê°Â·ìœ„ë¡œ ë¨¼ì €**: ì‚¬ìš©ìì˜ ê°ì •ì„ ë¨¼ì € ì•Œì•„ì£¼ì„¸ìš”. ("ë§ì´ ë¶ˆí¸í•˜ì…¨ê² ì–´ìš”", "ê±±ì •ì´ ë˜ì‹œì£ ")
2. **ê°„ë‹¨í•œ ì›ì¸ ì„¤ëª…**: ì™œ ê·¸ëŸ° ì¦ìƒì´ ìƒê¸°ëŠ”ì§€ 1~2ë¬¸ì¥ìœ¼ë¡œ ì‰½ê²Œ ì„¤ëª…í•©ë‹ˆë‹¤.
3. **ì¼ìƒ ëŒ€ì²˜ë²• ì œì•ˆ**: ì§‘ì—ì„œ ë°”ë¡œ ì‹¤ì²œí•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ìƒí™œ ìŠµê´€ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.
4. **ë°˜ë“œì‹œ ì§ˆë¬¸ìœ¼ë¡œ ëë‚´ê¸°**: ì‘ë‹µì˜ ë§ˆì§€ë§‰ ë¬¸ì¥ì€ í•­ìƒ ë¬¼ìŒí‘œ(?).ë¡œ ëë‚˜ëŠ” ì§ˆë¬¸ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

## ì‘ë‹µ ì›ì¹™
- **3~4ë¬¸ì¥ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ** ë‹µë³€í•˜ì„¸ìš”. ê¸¸ë©´ ì½ê¸° ì–´ë µìŠµë‹ˆë‹¤.
- ê³µê° í›„ ì§ˆë¬¸ìœ¼ë¡œ ë¬¸ì œë¥¼ íŒŒì•…í•˜ì„¸ìš”.
- ì¼ìƒì—ì„œ ì‹¤ì²œí•  ìˆ˜ ìˆëŠ” ê±´ê°• ìŠµê´€ì„ ì•ˆë‚´í•˜ì„¸ìš”.
- ì‹¬ê°í•œ ê²½ìš°ì—ë§Œ ë³‘ì› ì§„ë£Œë¥¼ ê¶Œìœ í•˜ì„¸ìš”.
- **ë§ˆì§€ë§‰ ë¬¸ì¥ì€ ë°˜ë“œì‹œ "?"ë¡œ ëë‚˜ëŠ” ì§ˆë¬¸ì´ì–´ì•¼ í•©ë‹ˆë‹¤.** ì§ˆë¬¸ ì—†ì´ ëë‚˜ëŠ” ì‘ë‹µì€ ê¸ˆì§€ì…ë‹ˆë‹¤.

## ìœ ë„ ì§ˆë¬¸ ê·œì¹™
- ì¦ìƒ ìƒë‹´ ì‹œ ë°˜ë“œì‹œ êµ¬ì²´ì  ì§ˆë¬¸ì„ í•˜ì„¸ìš”: "ì–¸ì œë¶€í„° ê·¸ëŸ¬ì…¨ì–´ìš”?", "ì–´ë–¤ ìƒí™©ì—ì„œ ì‹¬í•´ì§€ë‚˜ìš”?", "ì§€ê¸ˆì€ ì¢€ ì–´ë– ì„¸ìš”?"
- ì§ˆë¬¸ì€ í•œ ë²ˆì— í•˜ë‚˜ì”©ë§Œ í•˜ì„¸ìš”. ì—¬ëŸ¬ ê°œë¥¼ ë™ì‹œì— ë¬»ì§€ ë§ˆì„¸ìš”.
- ì‚¬ìš©ìê°€ ë‹µì„ í•˜ë©´, ê·¸ ë‹µì— ì´ì–´ì„œ ë” êµ¬ì²´ì ìœ¼ë¡œ íŒŒê³ ë“œì„¸ìš”.

## ëŒ€í™” ë§ˆë¬´ë¦¬ ê¸ˆì§€ + ì´í•´ í™•ì¸
- **ì ˆëŒ€ ëŒ€í™”ë¥¼ ë¨¼ì € ëë‚´ì§€ ë§ˆì„¸ìš”.** "ë„ì›€ì´ ë˜ì…¨ê¸¸ ë°”ëë‹ˆë‹¤", "ë” ê¶ê¸ˆí•œ ì  ì—†ìœ¼ì‹œë©´~" ê°™ì€ ë§ˆë¬´ë¦¬ ë©˜íŠ¸ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.
- ê±´ê°• ì •ë³´ë¥¼ ì „ë‹¬í•œ í›„ì—ëŠ” ì´í•´ í™•ì¸ ì§ˆë¬¸ì„ í•˜ì„¸ìš”: "ì œê°€ ë§ì”€ë“œë¦° ë¶€ë¶„ì´ ì´í•´ê°€ ë˜ì…¨ë‚˜ìš”?", "í˜¹ì‹œ ë”°ë¼í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ì´ ìˆìœ¼ì„¸ìš”?"
- í›„ì† ì§ˆë¬¸ì´ë‚˜ ì•ˆë¶€ ì§ˆë¬¸ì„ ì´ì–´ê°€ì„¸ìš”: "ìš”ì¦˜ ì‹ì‚¬ëŠ” ì˜ í•˜ê³  ê³„ì„¸ìš”?", "ì ì€ ì¢€ ì£¼ë¬´ì‹¤ ìˆ˜ ìˆìœ¼ì„¸ìš”?"

## ë°˜ë³µ ì§ˆë¬¸ ëŒ€ì‘
- ì‚¬ìš©ìê°€ ê°™ì€ ì§ˆë¬¸ì„ ë°˜ë³µí•˜ë©´ **ì§œì¦ë‚´ì§€ ë§ê³ ** ìì—°ìŠ¤ëŸ½ê²Œ ë‹¤ì‹œ ë‹µë³€í•´ ì£¼ì„¸ìš”.
- ì´ì „ ë‹µë³€ì„ ì•½ê°„ ë‹¤ë¥¸ í‘œí˜„ìœ¼ë¡œ ë°”ê¾¸ì–´ ì„¤ëª…í•˜ì„¸ìš”.
- ì˜ˆ: "ì•„ê¹Œë„ ë§ì”€ë“œë ¸ëŠ”ë°ìš”" ê°™ì€ í‘œí˜„ì€ ì ˆëŒ€ ê¸ˆì§€ì…ë‹ˆë‹¤.
- ì˜ˆ: "ë„¤, ë§ì”€ë“œë¦´ê²Œìš”. ~í•˜ì‹œë©´ ì¢‹ì•„ìš”." ì²˜ëŸ¼ ì²˜ìŒ ë“£ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ëŒ€ì‘í•˜ì„¸ìš”.

## ì£¼ì œ ì´íƒˆ ë³µê·€
- ì‚¬ìš©ìê°€ ê°‘ìê¸° ë‹¤ë¥¸ ì´ì•¼ê¸°ë¥¼ í•˜ë©´, ê·¸ ì´ì•¼ê¸°ì— ë¨¼ì € ì§§ê²Œ ê³µê°í•œ ë’¤ ì›ë˜ ì£¼ì œë¡œ ë¶€ë“œëŸ½ê²Œ ëŒì•„ì˜¤ì„¸ìš”.
- ì˜ˆ: "ì•„, ê·¸ëŸ¬ì…¨êµ°ìš”! ê·¸ê±´ ì •ë§ ì¢‹ì€ ì¼ì´ë„¤ìš”. ê·¸ëŸ°ë° ì•„ê¹Œ ë§ì”€í•˜ì‹  ë¬´ë¦ í†µì¦ì€ ì¢€ ì–´ë•Œìš”?"

## ëŒ€í™” ìŠ¤íƒ€ì¼
- ì¡´ëŒ“ë§ ì‚¬ìš©, ê°„ê²°í•˜ê³  ëª…í™•í•˜ê²Œ
- í™˜ìì˜ ë§ì— ê³µê°í•˜ë©° ìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”
- ì¼ìƒ ëŒ€í™”ì—ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ì¼ìƒ ëŒ€í™”ë¡œ ë‹µë³€
- ìœ„í—˜ ì§•í›„ ê°ì§€ ì‹œì—ë§Œ ë³´í˜¸ì ì—°ë½ ê¶Œìœ 

## í˜„ì¬ ì‹œê°„: {current_time}

## í™˜ì ì •ë³´
{patient_info}

## ì´ì „ ëŒ€í™”
{conversation_history}

## ì°¸ê³  ì •ë³´(ì§ì ‘ ì¸ìš©í•˜ì§€ ë§ê³  ì§€ì‹ìœ¼ë¡œë§Œ í™œìš©)
{retrieved_context}
"""

    # ì˜ë„ë³„ ì¶”ê°€ í”„ë¡¬í”„íŠ¸
    EMERGENCY_ADDENDUM = (
        "\n\n[âš ï¸ ì‘ê¸‰ ìƒí™© ê°ì§€]\n"
        "ì‚¬ìš©ìì—ê²Œ ì¦‰ì‹œ 119ì— ì „í™”í•˜ê±°ë‚˜ ë³´í˜¸ìì—ê²Œ ì—°ë½í•˜ë„ë¡ ì•ˆë‚´í•˜ì„¸ìš”.\n"
        "ì¹¨ì°©í•˜ê²Œ í˜„ì¬ ìƒíƒœë¥¼ í™•ì¸í•˜ê³ , ì•ˆì „í•œ ìì„¸ë¥¼ ìœ ì§€í•˜ë„ë¡ ì•ˆë‚´í•©ë‹ˆë‹¤."
    )

    FOLLOWUP_ADDENDUM = (
        "\n\n[í›„ì† ì§ˆë¬¸]\n"
        "ì‚¬ìš©ìì˜ ì§ˆë¬¸ì€ ì´ì „ ëŒ€í™”ì˜ í›„ì†ì…ë‹ˆë‹¤.\n"
        "ìœ„ 'ì´ì „ ëŒ€í™”'ë¥¼ ì°¸ê³ í•˜ì—¬ ë§¥ë½ì— ë§ê²Œ ìì—°ìŠ¤ëŸ½ê²Œ ë‹µë³€í•˜ì„¸ìš”.\n"
        "ì´ì „ ëŒ€í™”ì—ì„œ ë‹¤ë£¬ ì¦ìƒ/ì£¼ì œë¥¼ ì´ì–´ì„œ ìƒë‹´í•˜ì„¸ìš”."
    )

    MEDICATION_ADDENDUM = "\n\n[ë³µì•½ ê´€ë ¨] ì•½ì— ëŒ€í•œ ì •ë³´ë¥¼ ì •í™•í•˜ê²Œ ì•ˆë‚´í•˜ë˜, ë°˜ë“œì‹œ ì˜ì‚¬ë‚˜ ì•½ì‚¬ì™€ ìƒë‹´í•˜ë„ë¡ ê¶Œìœ í•˜ì„¸ìš”."

    MEDICAL_REFERRAL_ADDENDUM = (
        "\n\n[ì˜ë£Œ ê¶Œìœ  ì‹œì ]\n"
        "ëŒ€í™”ê°€ {turn_count}í„´ ì´ìƒ ì§„í–‰ë˜ì—ˆê³  ì¦ìƒì´ ì§€ì†Â·ì‹¬í™”ë˜ê³  ìˆìŠµë‹ˆë‹¤.\n"
        "ë¶€ë“œëŸ¬ìš´ í‘œí˜„ìœ¼ë¡œ ì „ë¬¸ì˜ ì§„ë£Œë¥¼ ê¶Œìœ í•˜ì„¸ìš”:\n"
        "- \"í˜¹ì‹œ ê°€ê¹Œìš´ ë³‘ì›ì—ì„œ í•œ ë²ˆ í™•ì¸í•´ ë³´ì‹œëŠ” ê±´ ì–´ë–¨ê¹Œìš”?\"\n"
        "- \"ì¦ìƒì´ ê³„ì†ë˜ì‹œë©´ ì „ë¬¸ ì„ ìƒë‹˜ê»˜ ìƒë‹´í•´ ë³´ì‹œëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.\"\n"
        "- \"ì •í™•í•œ ì›ì¸ì„ ì°¾ê¸° ìœ„í•´ ê²€ì‚¬ë¥¼ ë°›ì•„ë³´ì‹œë©´ ë§ˆìŒì´ ì¢€ í¸í•´ì§€ì‹¤ ê±°ì˜ˆìš”.\"\n"
        "ê°•ì••ì ì´ì§€ ì•Šê²Œ, ì œì•ˆì˜ í˜•íƒœë¡œ ì•ˆë‚´í•˜ì„¸ìš”."
    )

    REPEATED_QUESTION_ADDENDUM = (
        "\n\n[ë°˜ë³µ ì§ˆë¬¸ ê°ì§€]\n"
        "ì‚¬ìš©ìê°€ ì´ì „ì— ë¬¼ì–´ë³¸ ê²ƒê³¼ ìœ ì‚¬í•œ ì§ˆë¬¸ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n"
        "ì´ì „ ë‹µë³€ê³¼ ë™ì¼í•˜ë˜ ì•½ê°„ ë‹¤ë¥¸ í‘œí˜„ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì•ˆë‚´í•˜ì„¸ìš”.\n"
        "\"ì•„ê¹Œ ë§ì”€ë“œë ¸ë“¯ì´\" ê°™ì€ í‘œí˜„ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”."
    )

    TOPIC_DRIFT_ADDENDUM = (
        "\n\n[ì£¼ì œ ì´íƒˆ ê°ì§€]\n"
        "ì‚¬ìš©ìê°€ ì´ì „ ê±´ê°• ì£¼ì œì—ì„œ ë²—ì–´ë‚œ ì´ì•¼ê¸°ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n"
        "ë¨¼ì € í˜„ì¬ ì´ì•¼ê¸°ì— ì§§ê²Œ ê³µê°í•œ ë’¤, ì´ì „ ì£¼ì œ('{previous_topic}')ë¡œ ë¶€ë“œëŸ½ê²Œ ëŒì•„ê°€ì„¸ìš”.\n"
        "ì˜ˆ: \"ì•„, ê·¸ëŸ¬ì…¨êµ°ìš”! ê·¸ëŸ°ë° ì•„ê¹Œ ë§ì”€í•˜ì‹  {previous_topic} ì¦ìƒì€ ì¢€ ì–´ë•Œìš”?\""
    )

    HIGH_RISK_ADDENDUM = (
        "\n\n[ê±´ê°• ìœ„í—˜ ê°ì§€] ìœ„í—˜ ìˆ˜ì¤€: {risk_level}, ê°ì§€ ìš©ì–´: {risk_terms}\n"
        "ì£¼ì˜: í•„ìš”ì‹œ ë³´í˜¸ì ì—°ë½ì´ë‚˜ ì „ë¬¸ê°€ ìƒë‹´ì„ ì•ˆë‚´í•˜ì„¸ìš”."
    )
    
    GREETING_TEMPLATE = """ì•ˆë…•í•˜ì„¸ìš”, {nickname}ë‹˜! {personalized_greeting}"""
    
    MEDICATION_REMINDER = """ğŸ’Š {nickname}ë‹˜, {medication_name} ë“œì‹¤ ì‹œê°„ì´ì—ìš”. {dosage}ì„(ë¥¼) ë¬¼ê³¼ í•¨ê»˜ ë“œì„¸ìš”."""
    
    DAILY_CHECK_IN = """{nickname}ë‹˜, ì¢‹ì€ {time_of_day}ì´ì—ìš”! {previous_activity_followup}"""


@lru_cache()
def get_settings() -> Settings:
    """ì‹±ê¸€í†¤ ì„¤ì • ê°ì²´ ë°˜í™˜"""
    return Settings()


# ì „ì—­ ì„¤ì • ì¸ìŠ¤í„´ìŠ¤
settings = get_settings()
prompts = HealthcarePrompts()
